# Story 1.2: User Auth

## Status
Done

## Story
As a user, I want to sign up and log in securely so that I can access my personalized dashboard.

## Acceptance Criteria
1. Sign-up page exists at `/auth/signup` with email/password fields, inline validation, and clear error display.
2. Login page exists at `/auth/login` with email/password, inline validation, and clear error display.
3. Successful sign-up or login redirects to `/dashboard`.
4. Session persists using Supabase Auth; protected routes redirect unauthenticated users to `/auth/login`.
5. Logout control signs user out and returns to `/auth/login`.
6. Basic password reset entry point exists at `/auth/reset` (form UI and submit handler stub OK for MVP; email delivery may be wired later).
7. Unit/integration tests cover happy-path login and guard redirect behavior.

## Tasks / Subtasks
- [x] UI Forms
  - [x] Create `/auth/login`, `/auth/signup`, `/auth/reset` routes
  - [x] Implement forms with basic inline validation and error display
- [x] Supabase/Auth Integration
  - [x] Wire API login/signup; support Supabase login from App; accept Bearer in localStorage
  - [x] Protect `/dashboard` and other private routes via `RequireAuth`
- [x] UX polish
  - [x] Redirect to `/dashboard` on success; preserve `redirectTo` if present
  - [x] Sign-out redirects to `/auth/login`
- [ ] Tests
  - [ ] Unit: form validation schema tests (RHF/Zod optional later)
  - [ ] Integration: auth guard redirects unauthenticated → login; authenticated → dashboard
- [ ] Docs
  - [ ] Update `README.md` with local auth setup notes

## Dev Notes
- Reference `docs/front-end-spec/key-screens-mvp.md` for route list and `docs/front-end-spec/state-data.md` for session handling basics.
- Use `apps/web-react/src/ui/i18n.ts` for display strings and error messages.
- Ensure accessibility: label inputs, describe errors, and manage focus on submit.

### Testing
- Integration tests should simulate unauthenticated navigation to `/dashboard` and assert redirect to `/auth/login`.
- Integration tests should simulate login success and assert redirect to `/dashboard`.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-11 | 0.1 | Initial draft | SM |

## Dev Agent Record
- Agent Model Used:
- Debug Log References:
- Completion Notes List:
  - Added client-side routing and pages: `/auth/login`, `/auth/signup`, `/auth/reset`; protected `/dashboard`.
  - Implemented RequireAuth guard using `localStorage.sync_token`.
  - Existing App includes Supabase Auth login; guard accepts either API bearer or Supabase bearer in localStorage.
  - Logout in App clears token and redirects to `/auth/login`.
- File List:
  - Modified: `apps/web-react/src/main.tsx`
  - Added: `apps/web-react/src/ui/auth/RequireAuth.tsx`
  - Added: `apps/web-react/src/ui/auth/Login.tsx`
  - Added: `apps/web-react/src/ui/auth/Signup.tsx`
  - Added: `apps/web-react/src/ui/auth/Reset.tsx`
